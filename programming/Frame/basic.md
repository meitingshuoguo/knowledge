# 框架之间的对比

框架做的事情：

1. 根据状态渲染出真实 DOM（初始化阶段）

   重点在写法上，比如 React 是`JSX`，Vue 是`Mustache` 语法

2. 根据状态变化更新 DOM（更新阶段）

   重点在如何监听状态变化，以及接下来如何更新 DOM

## 变化侦测

通过状态生成 DOM，并将其输出到页面上显示出来，这个过程叫做渲染。通常，应用在运行时其内部状态会不断发生变化，此时需要不停的重新渲染。这时如何确定状态发生了变化？

- Angular 和 React 中，当状态发生变化，它不知道具体是哪个状态变了，只知道状态可能有变化。然后发送一个信号告诉框架，框架内部收到信号后，会进行一个暴力对比来找出哪些 DOM 节点需要重新渲染。在 Angular 中是脏检查的流程。React 中使用虚拟 DOM。（推的过程）
- Vue 中，当状态变化时，Vue 立刻就知道了，而且在一定程度上知道哪些状态变了，因此，它知道的信息更多，也就可以进行更细粒度的更细。（拉的过程）

  所谓更细粒度的更新就是说：假如有一个状态绑定着好多依赖，每个依赖表示一个具体的 DOM 节点，那么当这个状态发生变化时，向这个状态的所有依赖发送通知，让它们进行 DOM 更新操作。相比较而言，“拉的的粒度时最粗的。

  但是它也有一定的代价，因为粒度越细，每个状态所绑定的依赖就越多，依赖追踪在内存上的开销就会越大，因此 Vue2 开始，引入了虚拟 DOM，将粒度调整为中等粒度，即一个状态所绑定的依赖不再是具体的 DOM 节点，而是一个组件，这样状态变化后，会通知到组件，组件内部再使用虚拟 DOM 进行对比，这可以大大降低依赖数量，从而降低依赖追踪所消耗的内存。

  所以说 Vue 可以随意调整粒度。

> 《深入浅出 Vue.js - 刘博文》

## 操作 DOM

- jQuery 时代是命令式操作 DOM
- 现代三大主流框架都是声明式操作 DOM，把关注点主要放在状态维护上。
